// Unstacked by Adam Hinshaw & Elisa Lee : [adamhinshaw.com, elisalee.net]
var Utils={hexToRGBA:function(b,c){var f=Utils.hexToRgb(b);return"rgba("+f.r+","+f.g+","+f.b+","+(void 0==c?1:c)+")"},randomHex:function(){return"#"+Math.floor(16777215*Math.random()).toString(16)},rgbToHex:function(b,c,f){return"#"+Utils.componentToHex(b)+Utils.componentToHex(c)+Utils.componentToHex(f)},rgbColToHex:function(b){return"#"+Utils.componentToHex(b.r)+Utils.componentToHex(b.g)+Utils.componentToHex(b.b)},componentToHex:function(b){b=b.toString(16);return 1==b.length?"0"+b:b},hexToRgb:function(b){b=
b.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(b,f,p,L){return f+f+p+p+L+L});return(b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b))?{r:parseInt(b[1],16),g:parseInt(b[2],16),b:parseInt(b[3],16)}:null},lerpHex:function(b,c,f){null==b&&(b="FFFFFF");null==c&&(c="FFFFFF");return Utils.rgbColToHex(Utils.lerpRGB(Utils.hexToRgb(b),Utils.hexToRgb(c),f))},lerpRGB:function(b,c,f,p){null==b&&(b={r:0,g:0,b:0});null==c&&(c={r:0,g:0,b:0});b={r:parseInt(b.r+(c.r-b.r)*f),g:parseInt(b.g+(c.g-b.g)*f),
b:parseInt(b.b+(c.b-b.b)*f)};return!0===p?Utils.rgbColToHex(b):b},stepProcessArray:function(b,c){var f=b.concat();setTimeout(function(){c(f.shift());0<f.length&&setTimeout(arguments.callee,10)},10)},getURLParameter:function(b,c){var f=decodeURIComponent(((new RegExp("[?|&]"+b+"=([^&;]+?)(&|#|;|$)")).exec(location.search)||[,""])[1].replace(/\+/g,"%20"));return null==f||""==f||void 0==f?c:"boolean"===typeof c?"true"==f.toLowerCase()||"1"==f:"number"===typeof c&&(f=parseFloat(f),isNaN(f))?c:f},show:function(b){"string"==
typeof b&&(b=$(b));b.css("visibility","visible")},hide:function(b){"string"==typeof b&&(b=$(b));b.css("visibility","hidden")},isHidden:function(b){"string"==typeof b&&(b=$(b));return"hidden"==b.css("visibility")},sbool:function(b){return b?"1":"0"},limit:function(b,c,f){return null==b||b<c?c:b>f?f:b},pad:function(b,c,f){void 0==c&&(c=2);void 0==f&&(f="0");for(b+="";b.length<c;)b=f+b;return b},timeNow:function(){var b=new Date,c=b.getHours(),f=b.getMinutes(),b=b.getSeconds();return Utils.pad(c)+":"+
Utils.pad(f)+":"+Utils.pad(b)},getElapsedMilliseconds:function(){return(new Date).getTime()-Utils._app_start_time},getElapsedSeconds:function(){return Utils.getElapsedMilliseconds()/1E3},getUpTimeStr:function(){return"up:"+Utils.secondsToHMS(Utils.getElapsedSeconds())},secondsToHMS:function(b){var c=Math.floor(b/3600),f=Math.floor((b-3600*c)/60);b=Math.round(b-3600*c-60*f);return("0"+c).slice(-2)+":"+("0"+f).slice(-2)+":"+("0"+b).slice(-2)},shortDateString:function(b){null==Utils.__short_month_labels&&
(Utils.__short_month_labels="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "));null==Utils.__short_day_labels&&(Utils.__short_day_labels="Sun Mon Tue Wed Thu Fri Sat".split(" "));return Utils.__short_day_labels[b.getDay()]+" "+Utils.__short_month_labels[b.getMonth()]+" "+Utils.getGetOrdinal(b.getDate())+", "+b.getHours()+":"+Utils.pad(b.getMinutes())+":"+Utils.pad(b.getSeconds())},getLongMonthName:function(b){null==Utils.__month_labels&&(Utils.__month_labels="January Febuary March April May June July August September October November December".split(" "));
return Utils.__month_labels[b.getMonth()]},secondsTillMidnight:function(b){var c=new Date(b);c.setHours(24,0,0,0);return(c-b)/1E3},getGetOrdinal:function(b){var c=["th","st","nd","rd"],f=b%100;return b+(c[(f-20)%10]||c[f]||c[0])},getSQLTimeStamp:function(b){return b.getFullYear()+"-"+Utils.pad(b.getMonth()+1)+"-"+Utils.pad(b.getDate())+" "+Utils.pad(b.getHours())+":"+Utils.pad(b.getMinutes())+":"+Utils.pad(b.getSeconds())},getTimeZoneOffset:function(b){if(!0===b)return(new Date).toString().match(/([A-Z]+[\+-][0-9]+.*)/)[1];
b=(new Date).getTimezoneOffset();return b=(0>b?"+":"-")+Utils.pad(parseInt(Math.abs(b/60)))+Utils.pad(Math.abs(b%60))},escapeUnicode:function(b){console.log(b);return decodeURIComponent(escape(b))},isMobile:{Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},iPad:function(){return navigator.userAgent.match(/iPad/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},
Windows:function(){return navigator.userAgent.match(/IEMobile/i)||navigator.userAgent.match(/WPDesktop/i)},any:function(){return Utils.isMobile.Android()||Utils.isMobile.BlackBerry()||Utils.isMobile.iOS()||Utils.isMobile.Opera()||Utils.isMobile.Windows()}}};Utils._app_start_time=(new Date).getTime();Utils.QueryObject=function(){this.refresh()};
Utils.QueryObject.prototype.refresh=function(){this.value_table={};this.indexed_key_list=[];var b=location.search;if(1<b.length)for(var b=b.split("&"),c=0;c<b.length;c++){var f=b[c].split("="),p=f[0];0==c&&(p=p.substr(1));this.value_table[p]=f[1];this.indexed_key_list.push(p)}};Utils.QueryObject.prototype.size=function(){return this.indexed_key_list.length};Utils.QueryObject.prototype.setVar=function(b,c){this.exists(b)||this.indexed_key_list.push(b);this.value_table[b]=c};
Utils.QueryObject.prototype.exists=function(b){return this.value_table.hasOwnProperty(b)};Utils.QueryObject.prototype.getVar=function(b){return this.value_table[b]};Utils.QueryObject.prototype.getVarAtIndex=function(b){return 0>b||b>=this.size()?void 0:this.value_table[this.indexed_key_list[b]]};
Utils.QueryObject.prototype.serialize=function(b){for(var c="?",f=0;f<this.indexed_key_list.length;f++){var p=this.value_table[this.indexed_key_list[f]];"boolean"==typeof p&&(p=Utils.sbool(p));c+=(1<c.length?"&":"")+this.indexed_key_list[f]+"="+(void 0==p?"":p)}!0===b&&(c=encodeURIComponent(c));return c};Utils.QueryObject.prototype.reloadToPage=function(){location.replace(this.getAsURL())};
Utils.QueryObject.prototype.getAsURL=function(b){return(location.hasOwnProperty("origin")?location.origin:location.protocol+"//"+location.host)+location.pathname+this.serialize(b)};
Utils.getQueries=function(){return new Utils.QueryObject}(function(){for(var b=0,c=["ms","moz","webkit","o"],f=0;f<c.length&&!window.requestAnimationFrame;++f)window.requestAnimationFrame=window[c[f]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[f]+"CancelAnimationFrame"]||window[c[f]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(c,f){var B=(new Date).getTime(),M=Math.max(0,16-(B-b)),ga=window.setTimeout(function(){c(B+M)},M);b=
B+M;return ga});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(b){clearTimeout(b)})}());var UnstackedApp=function(){var b,c;function f(){k("autoCloseHome");N(1,p)}function p(){k("homeHidden");Da&&L()}function L(){k("showInstruction",ha);V=!0;$("#instruction-box").css({display:"block",visibility:"visible"});TweenMax.fromTo("#instruction-box",.5,{scale:0},{scale:1,ease:Power2.easeOut});$("#u_overlay_bg").css({opacity:0});Utils.show("#u_overlay_bg");ha&&(Ea=setTimeout(M,15E3));$("#u_overlay_bg, #instruction-box").click(function(a){B(a.shiftKey?10:1);z("close_instruction","click")})}function B(a){k("closeInstruction",
a);V=!1;ha&&clearTimeout(Ea);$("#u_overlay_bg, #instruction-box").unbind("click");$("#instruction-box").css({display:"block"});TweenMax.to("#instruction-box",.33*a,{scale:0,ease:Power2.easeOut,onComplete:ga});Utils.hide("#u_overlay_bg")}function M(){k("autoCloseInstructions");B(1)}function ga(){$("#instruction-box").css({display:"none"})}function A(){if(I){var a=new l(gb);a.setSeconds(a.getSeconds()+Utils.getElapsedSeconds()*Fa);return a}return new l}function Ga(a,d,g,b){var e=a.getHours(),c="";d&&
(c=12<=e?"pm":"am",e=(e%=12)?e:12);d=":";null!=b&&b.length&&(d=b.split("$").join(":"));b="0"+a.getMinutes();a="0"+a.getSeconds();return e+d+b.substr(-2)+(!0===g?":"+a.substr(-2):"")+c}function k(){hb&&(Array.prototype.unshift.apply(arguments,[Ga(new Date)]),console.log.apply(null,arguments))}function z(a,d,g,b){window.ga&&(k("trackEvent",a,d,g,b),window.ga("send","event",a,d,g,b))}function Ha(){k("toggleMenu",J);J?($("#u_menu_options, #u_menu_about, #u_menu_about .section_title").hide(),$(".u_menu_sel").removeClass("u_menu_max").addClass("u_menu_min"),
$("#u_menu_header_minimised").show(),$("#u_menu_header_maximised").css({display:"none"}),ia(!0,!1,!0)):($(".u_menu_sel").removeClass("u_menu_min").addClass("u_menu_max"),$("#u_menu_header_maximised").css({display:"block"}),$("#u_menu_header_minimised").hide(),$("#u_menu_options, #u_menu_about, #u_menu_about .section_title").show());z("menu",J?"close":"open");J=!J;F()}function ib(a){$("#u_menu_header_minimised, #u_menu_header_maximised").click(Ha);$("#u_menu_options .section_title").click(function(){ia(!0,
!0);z("menu_section","click","settings")});$("#u_menu_about .section_title").click(function(){ia(!1,!0);z("menu_section","click","about")});$("#u_menu_options .u_source_0").click(function(){W("data_source",r.BOTH.value,this)});$("#u_menu_options .u_source_1").click(function(){W("data_source",r.UNPUB.value,this)});$("#u_menu_options .u_source_2").click(function(){W("data_source",r.PUB.value,this)});$("#u_menu_options .u_imgs_0").click(function(){W("img_source",C!=u.WITH_IMAGE.value,this)});!0===a?
(w.prepend($("#u_menu").removeAttr("id")),w.fixPos({top:0,left:0,block:$(".u_menu_sel")})):($("#u_menu").css({"max-width":405}),$("#u_menu_header_minimised").css({"min-width":220}),$("#u_menu").show());jb&&setTimeout(function(){k("auto menu toggle timeout");Ha()},200)}function ia(a,d,g){a?($("#u_menu_about .about_footer, #u_menu_about .about_content, #u_menu_options .section_title").hide(),$("#u_menu_about .section_title, #u_menu_options .options_content").show()):($("#u_menu_about .about_footer, #u_menu_about .about_content, #u_menu_options .section_title").show(),
$("#u_menu_about .section_title, #u_menu_options .options_content").hide());!0!==g&&F()}function W(a,d,g){k("menuClickAction",a,d,g);z("menu_click_action",a,d);if("img_source"==a){if(C==d)return;C=d?1:0;$(g).children(".label").text(d?"On":"Off");d?($(g).toggleClass("selected_row",!0).toggleClass("clickable_row",!1),$(g).addClass("u_menu_border_v_shadows")):($(g).toggleClass("selected_row",!1).toggleClass("clickable_row",!0),$(g).removeClass("u_menu_border_v_shadows"))}else{if(D==d)return;D=d;$("#u_menu_options .options_content .u_menu_source_items .selected_row").addClass("clickable_row").removeClass("selected_row").removeClass("u_menu_border_v_shadows");
$(".u_menu_source_items > .row").removeClass("u_menu_item_divider");$(g).addClass("selected_row").addClass("u_menu_border_v_shadows").removeClass("clickable_row");1!=d&&$(".u_menu_source_items > .clickable_row").eq(0).addClass("u_menu_item_divider")}ja()}function ja(){k("filterWall",D,C);var a="";switch(D){case r.UNPUB.value:a=".u_unpub";break;case r.PUB.value:a=".u_pub"}switch(C){case u.WITH_IMAGE.value:a+=".u_has_img";break;case u.WITHOUT_IMAGE.value:a+=".u_no_img"}0==a.length?w.unFilter():(X&&
(a+=",.u_menu_sel"),k(a),w.filter(a))}function ka(){k("fetchData");var a;v?(a=kb+"?",Ia.length&&(a+="&"+Ia),x()&&(a+="&fiche"),(la||I)&&-1==a.indexOf("since=")?a+="since="+ma:0<na&&!I&&(a+="&pre_fetch_mins="+na),I&&-1==a.indexOf("now=")&&(a+="&now="+Utils.getSQLTimeStamp(A()))):a=lb;$.ajax({dataType:"json",url:a,success:mb,error:nb})}function oa(a){y||(k("START",1==a),requestAnimationFrame(Ja),y=!0,!0!==a&&t.setValue("Playing",y))}function pa(a){y&&(k("STOP",1==a),y=!1,!0!==a&&t.setValue("Playing",
y))}function Ja(a){Y.begin();if(y){Ka();var d=m.length,g=0,b=0,c=0;for(a=Z+1;a<d;a++){var f=m[a];if(f.date.getTime()<=e.playback_date.getTime())if(O())k("Not adding new view as animating");else{k("Viewed",a,Utils.shortDateString(f.date),Utils.shortDateString(e.playback_date),f.date.getTime(),e.playback_date.getTime());if(!v){var h=f,l=e.canvas.getContext("2d");l.strokeStyle="#00ff00";l.lineWidth=1;l.globalAlpha=1;var ob=e.canvas.height/2-3,p=e.canvas.height/2+3;l.beginPath();var n=(h.date-e.start_date)/
1E3/e.duration_secs*e.canvas.width;h.isPublished()?(l.moveTo(n,p),l.lineTo(n,e.canvas.height)):(l.moveTo(n,0),l.lineTo(n,ob));l.stroke();l.globalAlpha=1}La(f);f.hasImage()?c++:b++;Z=a;g++}else break}0<b&&0==c&&(0<P.length&&Ma(),F());if(0<G&&0==Q&&(d=aa.length,g=[],d>G)){k("over visible limit, about to remove",d-G);for(a=0;a<d-G;a++)b=aa.shift(),k(" About to remove:",b),g.push(b),$("div[data-id="+b+"]").remove();F()}X&&(a=A(),d='<span class="tcolon" style="visibility:'+(0==a.getSeconds()%2?"hidden":
"visible")+';">$</span>',d=Ga(a,!0,pb,d),a=a.getDate()+" "+Utils.getLongMonthName(a)+" "+a.getFullYear()+", ",$(".u_menu_sel .time_stamp").html(d),$(".u_menu_sel .date").html(a));K&&qa()}Y.end();requestAnimationFrame(Ja)}function Ka(){if(v)e.playback_date.setTime(A().getTime()-6E4),e.end_date.setTime(e.playback_date.getTime()),e.position=1;else{e.playback_date.setTime(e.playback_date.getTime()+1E3*e.playback_seconds_step);e.position=(e.playback_date.getTime()-e.start_date.getTime())/1E3/e.duration_secs;
1<e.position&&pa();$("#playback_date").text(Utils.shortDateString(e.playback_date));var a=e.canvas.width*e.position;$("#playback_date").css({left:a+10+"px"});$("#timeline_pos_canvas").css({left:a+"px"})}}function x(){return Na==Oa.FICHE.value}function Pa(){var a=ba.x,d=ba.y,g=window.innerWidth,b=window.innerHeight,e=parseInt($("#freewall").attr("data-wall-width"));isNaN(e)&&(e=$("#unstacked").outerWidth());var e=e+(2*ca+2*R),c=$(document).height();window.scrollTo(a/g*(e-g),d/b*(c-b))}function Qa(a){e.playback_date.setTime(e.start_date.getTime()+
a*e.duration_secs*1E3);e.position=(e.playback_date.getTime()-e.start_date.getTime())/1E3/e.duration_secs;a=e.start_date;null==a&&(a=e.start_date);for(var d=m.length,b=0,c=0;c<d;c++)if(m[c].date>=a)if(m[c].date<=e.playback_date)b++;else break;Z=b}function qa(){var a=m.length;null!=e.start_date&&$("#status > p").text(Utils.getUpTimeStr()+", running="+y+",  views{to:"+Z+", total:"+a+", visible:"+aa.length+", items:"+m.length+"}, anim="+E+", wall_anim="+w.isAnimating()+", disp_mode="+Na+", pub/unpub="+
H.pub_count+"/"+H.unpub_count+(v?"":", start="+Utils.shortDateString(e.start_date)+" --\x3e end="+Utils.shortDateString(e.end_date))+" now="+Utils.shortDateString(e.playback_date)+(v?", realtime="+A().toLocaleTimeString():"")+", pos="+e.position.toFixed(4)+", data_src="+D+", cached_data_date="+Ra)}function Sa(a){a?(qa(),$("#status").show(0)):$("#status").hide(0)}function Ta(a){a&&!v?(ra(),$("#timeline").show(0)):$("#timeline").hide(0)}function qb(){0==$("head > #page-css").length&&$("head").append('<style id="sd-page-css" type="text/css"></style>');
var a="";2==E?a+="\n#unstacked .card {transform:scale(0); transition:transform .5s ease .33s, left .5s ease, top .5s ease; }":3==E&&(a+="\n#unstacked .card {transform:scale(0); }");a+="\n#unstacked .free-wall { margin: "+ca+"px; }";Ua&&(a+="\nbody { overflow:hidden; }");$("head > #sd-page-css").html(a)}function mb(a){a.hasOwnProperty("now")&&(ma=a.now);a.hasOwnProperty("trans")&&(Ra=a.trans);if(a.hasOwnProperty("views")){var d=a.views.length;k(d+" views",a);for(var b=0,c=0;c<d;c++,b++){var f=q.fromJson(a.views[c],
b);m.push(f);f.isPublished()?(H.pub_count++,f.hasImage()&&H.pub_covers.thumb++,f.hasRegularImage()&&H.pub_covers.regular++):(H.unpub_count++,f.hasImage()&&H.unpub_w_image++)}m.sort(function(a,d){return a.date.getTime()>d.date.getTime()?1:a.date.getTime()<d.date.getTime()?-1:0});d=m.length;for(c=0;c<d;c++)m[c].index=c;v||(d&&(e.start_date=new l(m[0].date),e.end_date=new l(m[m.length-1].date),e.duration_secs=(e.end_date-e.start_date)/1E3,e.playback_date=new l(e.start_date),e.position=0),ra(),$("#timeline_labels").text(""),
0<Va&&Qa(Va),Ta(S));if(rb)for(k("ADDING ALL!"),c=0;c<d;c++)La(m[c]);else la||y||(oa(),x()&&(sa=!1));la=!0}else console.error("Json missing 'views'");v&&sa&&setTimeout(ka,I?ta/Fa:ta)}function nb(a,d,b){console.error("dataLoadError",d,b);v&&sa&&setTimeout(ka,ta)}function sb(a){var d=Math.random();null!=a?a.isPublished()?d=a.hasRegularImage()?Math.min(.25,d):a.hasImage()?Math.min(.25,d):0:a.hasRegularImage()&&(d=Math.min(1,d+.5)):d=1;return(1+2*d)*ua}function La(a){var d=sb(a),b=a.index,e=a.getDivID(),
c=a.title,f="",h=!da||!a.isPublished()&&!a.hasImage()&&!T,l=h?"visibility:hidden;":"";a.isPublished()?(c=a.call_num.length?a.call_num:"",0==c.length&&(c=a.dewey.length?a.dewey:""),l+="background-color:"+n.getRGBA(a.dewey_index,.8)+";"):a.hasImage()?(f=a.creator.length?a.creator:"",f+=a.date_of_work.length?(f.length?", ":"")+a.date_of_work:"",f+=a.dig_no.length?(f.length?", ":"")+a.dig_no:""):(c=a.call_num.length?a.call_num:"",l+="background-color:#333333;");1>c.length&&1>f.length&&h&&(l+="display:none;");
b="<div class='card_text_label' style='"+l+"' ><p class='debug_label' style='display:"+(T?"block":"none")+"'; >"+b+": "+a.getDateString()+"</p><p class='title' >"+c+"</p>"+(f.length?"<p class='date' >"+f+"</p>":"")+"</div>";c=a.isPublished()?"u_pub":"u_unpub";a.hasImage()?(f=a.getImageURL(a.hasRegularImage()?"img_r":"img_t"),b="<div data-id='"+e+"' class='card u_has_img "+c+"' style='width:"+d+"px; visibility:hidden;'><img src='"+f+"' class='unselectable undragable' width='100%'>"+b+"</div>",Q++,
$("#freewall").prepend(b),d=function(a){"error"==a.type&&console.error("Image load fail",a.target.currentSrc);Q--;ea.push(e);if(0==Q){k("allImagesLoaded",Q,ea.length);for(a=ea.length;-1<--a;){var d=ea.pop(),d=$("div[data-id="+d+"]");d.css({visibility:"visible"});3==E?TweenMax.to(d,.5,Wa):0!=E&&d.css({transform:"scale(1)"})}0<P.length&&Ma();F()}},$("div[data-id="+e+"] > img").load(d).error(d)):(d=Math.round(1*ua),b="<div data-id='"+e+"' class='card u_no_img "+c+"' style='width:"+d+"px; ' >"+b+"</div>",
$("#freewall").prepend(b),tb(e,a,d),P.push(e));$("div[data-id="+e+"]").click(ub);Xa&&(a="Ab A Bb B C C# D Eb E F F# G".split(" ")[a.isPublished()?a.dewey_index:11],d=[3,4,5][Math.floor(3*Math.random())],b=Math.random()+.5,va.pan.value=2*Math.random()-1,k(a+d,b,va.pan.value),wa.triggerAttackRelease([a+d],b));aa.push(e)}function Ma(){k("showAllImagelessReady");for(var a=P.length;-1<--a;){var d=P.pop();3==E?TweenMax.to($("div[data-id="+d+"]"),.5,Wa):$("div[data-id="+d+"]").css({transform:"scale(1)"})}}
function F(a){var d=Utils.isMobile.any();null==a&&(a=x()?4*window.innerWidth:(d?window.width:window.innerWidth)-(2*ca+2*R));xa&&J&&!d&&(a=$("#u_menu")[0].getBoundingClientRect().left-(ca/2+R));k("reflowGrid",a);X&&!xa?(w.fitWidth(a),w.fillHoles()):w.fitWidth(a)}function O(){return 0==E?w.isAnimating():w.isAnimating()||TweenMax.isTweening("#details-card")||TweenMax.isTweening("#u_overlay_bg")||TweenMax.isTweening("#instruction-box")}function ub(a){k("coverClick",a);if(O())k("Can't launch as something is animating");
else{c=$(a.currentTarget);var d=parseInt(c.attr("data-id").substr(4));k("clicked id of ",c.attr("data-id"),d);vb(d,a.shiftKey)}}function tb(a,d,b){var e="#333333";d.isPublished()&&(e=n.getHex(d.dewey_index));$("div[data-id="+a+"]").prepend("<div id='cover_"+d.index+"' class='cover' style='min-height:"+b+"px' ><p>"+d.title+"</p></div>");$("div[data-id="+a+"]").css({"background-color":e});$("div[data-id="+a+"] > .card_text_label > .title").text()}function ra(){if(null==e.canvas){e.canvas=document.createElement("canvas");
e.canvas.id="timeline_canvas";e.canvas.height=48;$("#unstacked").append('<div id="timeline"> <div id="timeline_labels">Start Time - End Time</div> </div>');$("#timeline").append(e.canvas);e.canvas.onclick=function(a){var b=a.offsetX/e.canvas.width;k("timeinle press",a,b);Qa(b);y||Ka()};$("#timeline").append('<div id="playback_date">0:00:00</div>');e.position_canvas=document.createElement("canvas");e.position_canvas.id="timeline_pos_canvas";e.position_canvas.width=1;e.position_canvas.height=78;var a=
e.position_canvas.getContext("2d");a.fillStyle="#FF0000";a.fillRect(0,0,e.position_canvas.width,e.position_canvas.height);$("#timeline").append(e.position_canvas)}e.canvas.width=$("#unstacked").width()-20;a=e.canvas.getContext("2d");a.fillStyle="#7e5944";a.fillRect(0,0,e.canvas.width,e.canvas.height);var d=(e.end_date-e.start_date)/864E5,b=e.canvas.width/d;a.fillStyle="#EFE0B9";var c=Math.ceil(d);if(0<c)for(var d=Utils.secondsTillMidnight(e.start_date),f=d/86400*b,d=1;d<c;d++)0!=d%2&&(a.fillRect(f,
0,b,e.canvas.height),f+=2*b);b=e.canvas.height/2-3;c=e.canvas.height/2+3;a.strokeStyle="#000000";a.lineWidth=1;a.globalAlpha=.75;a.beginPath();for(d=0;d<m.length;d++)m[d].hasImage()&&(f=(m[d].date-e.start_date)/1E3/e.duration_secs,f*=e.canvas.width,m[d].isPublished()?(a.moveTo(f,c),a.lineTo(f,e.canvas.height)):(a.moveTo(f,0),a.lineTo(f,b)));a.stroke();a.strokeStyle="#FFFFFF";a.globalAlpha=.66;a.beginPath();for(d=0;d<m.length;d++)m[d].hasImage()||(f=(m[d].date-e.start_date)/1E3/e.duration_secs,f*=
e.canvas.width,m[d].isPublished()?(a.moveTo(f,c),a.lineTo(f,e.canvas.height)):(a.moveTo(f,0),a.lineTo(f,b)));a.stroke();a.globalAlpha=1}function vb(a,d){var g=b=m[a];k("showDetailsView",a,g.toString(),g);z("show_details_view",a);var c=$("#details-labels > p");c.text("");if(g.isPublished())g.hasImage()&&c.eq(0).html('<span class="heading" >'+g.title+"</span>"),g.date_of_work.length&&c.eq(1).html('<span class="heading" >Published:</span>'+g.date_of_work),g.call_num.length?c.eq(2).html('<span class="heading" >Call Number:</span>'+
g.call_num):g.dig_no.length&&c.eq(2).html('<span class="heading" >Digital Order Number:</span>'+g.dig_no),g.isbn.length&&c.eq(3).html('<span class="heading" >ISBN:</span>'+g.isbn);else{c.eq(0).html('<span class="heading" >'+g.title+"</span>");var e="";g.creator.length&&(e=g.creator);g.date_of_work.length&&(e+=(e.length?", ":"")+g.date_of_work);g.location.length&&(e+=(e.length?", ":"")+g.location.join(", "));e.length&&c.eq(1).text(e);g.dig_no.length?c.eq(3).html('<span class="heading" >Digital Order Number:</span>'+
g.dig_no):g.call_num.length&&c.eq(3).html('<span class="heading" >Call Number:</span>'+g.call_num)}g.topics.length&&c.eq(4).html('<span class="heading" >Topics:</span>'+g.topics.join(", "));c=g.getLocationURL();e=0<c.length&&!x();$("#details-link-anchor").attr("href",c).css({display:e?"initial":"none",visibility:e?"visible":"hidden"});$("#details-card > #details-labels").css({"padding-right":e?"40px":"12px"});var f=1==d?10:1,h=$("#details-card > #hero-img").toggleClass("pub_details_cover_img",g.hasImage()&&
g.isPublished());g.hasImage()?(c=g.getBestImgUrl(wb?"":"img_l"),h.load(function(){k("image loaded",$(this).attr("src"));$("#u_overlay > #loading_spinner").hide();Utils.show($(this));ya();Ya(f);Utils.show("#details-card")}),$("#u_overlay > #loading_spinner").show(330),h.attr("src")!=c?h.attr("src",c):setTimeout(function(){h.load()},100),Utils.hide($("#details-card > #details-no-image"))):(Utils.hide(h.attr("src","")),$("#details-card > #details-no-image > #details-big-text").text(g.title),Utils.show($("#details-card > #details-no-image")));
Za(g.isPublished()?n.getHex(g.dewey_index):"#333333",g.hasImage(),f)}function Za(a,b,g,c){U=!0;$("#details-card").css({"background-color":a,visibility:b?"hidden":"visible",display:"block"});b||(ya(),Ya(g));Utils.show($("#u_overlay"));g=isNaN(g)?1:g;TweenMax.to("#u_overlay_bg",.33*g,{autoAlpha:1,delay:.2*g})}function N(a,d){k("hideDetailsView");O()?k("Can't hide details view as animating"):(null!=d||Utils.isHidden("#home-box")||(d=p),za&&clearTimeout($a),U=!1,a=null==a||isNaN(a)?1:a,TweenMax.to("#u_overlay_bg",
.25*a,{autoAlpha:0,delay:.25*a,onComplete:function(){var a=d;b=c=null;$("#u_overlay, #u_overlay_bg, #details-card, #details-card > #hero-img, #details-card > #details-no-image, #home-box, #instruction-box").css({visibility:"hidden"});$("#details-card").css({width:"1px",height:"1px",display:"none"});a&&"function"==typeof a&&a()}}),$("#details-card").unbind("click"),$("#u_overlay_bg").unbind("click"),xb(a))}function Ya(a){var d=ab();a=null==a||isNaN(a)?1:a;k("buildOnDetailsCard",a,d);var g=$("#details-labels").outerHeight(),
c=$("#details-card").outerHeight(),d={scaleX:d.scaleX,scaleY:d.scaleY,top:d.top+"px",left:d.left+"px",height:c-g+"px",autoAlpha:0},c={scale:1,top:"0px",left:"0px",height:c+"px",autoAlpha:1,ease:Power2.easeOut,onComplete:yb};b&&b.isPublished()&&b.hasImage()&&(d.width=$("#details-card > #hero-img").outerWidth(),c.width=$("#details-card").outerWidth());TweenMax.fromTo("#details-card",.5*a,d,c);$("#u_overlay_bg").click(function(a){k("click on u_overlay_bg");N(a.shiftKey?10:1);z("close_details_view","click",
"overlay_bg")})}function yb(){k("detailsCardBuiltOn");$("#details-card").click(function(a){var d=function(a,b){return a.id==b||$(a).parents("#"+b).size()};if(d(a.target,"details-link-anchor"))z("details_view_anchor","click");else{if(d(a.target,"details-labels"))return a.altKey&&console.log(b),a.stopPropagation(),a.preventDefault(),a.stopImmediatePropagation(),!1;z("close_details_view","click","details_view");N(a.shiftKey?10:1)}})}function xb(a){var d=ab();a=null==a||isNaN(a)?1:a;var c=$("#details-labels").outerHeight(),
e=$("#details-card").outerHeight(),d={autoAlpha:0,scaleX:d.scaleX,scaleY:d.scaleY,top:d.top+"px",left:d.left+"px",height:e-c+"px"};b&&b.isPublished()&&b.hasImage()&&(d.width=$("#details-card > #hero-img").outerWidth());TweenMax.to("#details-card",.5*a,d)}function ab(){var a=bb();if(null==c)var b=320,g=240,e=-.5*b,f=-.5*g;else f=c.offset(),b=c.width(),g=c.height(),e=f.left+b/2-window.scrollX-window.innerWidth/2,f=f.top+g/2-window.scrollY-window.innerHeight/2;b/=a.width;a=g/a.height;return{left:e,top:f,
scaleX:b,scaleY:a}}function bb(){var a=.9*window.innerHeight,d;d=window.innerWidth>window.innerHeight;var c="";if(""!=$("#details-card > #hero-img").attr("src")){var e=$("#details-card > #hero-img"),f=e[0].naturalWidth,h=e[0].naturalHeight,e=f>h,k=window.innerWidth-30,l=window.innerHeight-30;if(b.isPublished())b.isPublished()?(c=$("#details-labels").outerHeight(),m=d?1.1*f/h:2/3,d=d?a*m:a/m,d>k&&(d=k,a=d/m),a>l&&(a=l,d=a*m),c=a-c):(m=e?f/h:h/f,d=e?a*m:a/m,d>k&&(d=k),a=e?d/m:d*m);else{var c=$("#details-labels").outerHeight(),
m=e?f/h:h/f;b.isPublished()&&(m=1.1*f/h);d=e?(a-c)*m:(a-c)/m;d>k&&(d=k,a=e?d/m+c:d*m+c);a>l&&(a=l,d=e?(a-c)*m:(a-c)/m);c=a-c}}else f=d?1.5:2/3,d=a*f,d>window.innerWidth-30&&(d=window.innerWidth-30,a=d/f);return{width:d,height:a,img_h:c}}function ya(a){null==a&&(a=bb());a.hasOwnProperty("img_h")||(a.img_h=0);k("sizeDetailsView",a.height,a.width,a.img_h);$("#details-card").css({height:a.height+"px",width:a.width+"px"});$("#details-card > #hero-img").css({height:a.img_h});a=$("#details-labels > p");
for(var b=!1,c=0;c<a.length;c++)if(a[c].clientWidth<a[c].scrollWidth||a[c].clientHeight<a[c].scrollHeight){b=!0;break}b&&k("Truncated Text @ details-label p["+c+"]")}function zb(a){setTimeout(function(){cb(!0)},250)}function Ab(a){cb()}function cb(a){!0===a&&F();k("resize",window.innerWidth,window.innerHeight,window.scrollY);S&&ra();U&&ya();a=t._panel.style.top.split("px")[0];t.setPosition(window.innerWidth-170,a);x()&&Pa()}function Bb(a){var b=t._panel.style.left.split("px")[0];t.setPosition(b,window.scrollY+
45);O()||(U&&N(a.shiftKey?10:1),V&&B(a.shiftKey?10:1))}function Cb(a){var b=a.clientY;ba.x=a.clientX;ba.y=b;x()&&Pa()}function Db(a){switch(a.keyCode){case 27:O()||(U&&N(a.shiftKey?10:1),V&&B(a.shiftKey?10:1));break;case 76:a.altKey&&(da=!da,$(".card_text_label, #details-labels").css({visibility:da?"visible":"hidden"}));break;case 83:a.altKey&&(K=!K,Sa(K));break;case 85:a.altKey&&(t.toggleVisibility(),Aa=!Aa);break;case 84:a.altKey&&(S=!S,Ta(S));break;case 68:a.altKey&&a.shiftKey&&(T=!T,$(".card_text_label").show(),
$(".card_text_label > .debug_label").toggle(T));break;case 80:y?(pa(),K&&qa()):oa()}}var h=Utils.getURLParameter,Ba=h("remote",!0),Eb=(Ba?"http://unstacked.dxlab.sl.nsw.gov.au/":"")+"cache/imgs/covers/",Fb=(Ba?"http://unstacked.dxlab.sl.nsw.gov.au/":"")+"cache/imgs/acms.sl.nsw.gov.au/",db=(Ba?"http://unstacked.dxlab.sl.nsw.gov.au/":"")+"php/",lb=db+"get_data.php",kb=db+"get_views.php",r={BOTH:{value:0,label:"Both"},UNPUB:{value:1,label:"Non-published"},PUB:{value:2,label:"Published"}},u={ALL:{value:0,
label:"Show All"},WITH_IMAGE:{value:1,label:"With Images"},WITHOUT_IMAGE:{value:2,label:"Without Images"}},Oa={INTERACTIVE:{value:0,label:"Interactive"},DISPLAY:{value:1,label:"Display"},FICHE:{value:2,label:"Fiche"}},m=[],Z=-1,H={unpub_count:0,unpub_w_image:0,pub_count:0,pub_covers:{thumb:0,regular:0}},v=h("live_mode",!0),ta=1E3*h("live_refresh_interval",60),na=h("live_start_offset_mins",0),fa=h("playback_speed",1/60),da=h("show_labels",!0),C=h("img_display_src",u.ALL.value),S=h("show_timeline",
!0)&&!v,D=h("data_src",r.BOTH.value),Na=h("display_mode",Oa.INTERACTIVE.value),rb=h("add_all",!1),wb=h("get_large_imgs",!1),G=h("visible_limit",64)*(Utils.isMobile.any()?.5:1);x()&&(G=0);var Gb=h("generated_secs",!0),Ua=h("hide_scroll",!1),Aa=h("dev_ui",!1),X=h("menu",!x()),xa=h("menu_on_top",!1),jb=h("auto_open_menu",!1),J=!1,Hb=h("show_home",!x()),za=h("auto_close_home",!0),I=h("abs_date_mode",!1),gb=h("abs_start_date","2016-03-22 08:59"),Fa=Math.abs(h("abs_date_speed",1)),$a,Da=h("show_instruction",
!x()),ha=h("auto_close_instructions",!0),Ea,sa=h("auto_refresh",!0),Ia=h("extra_data_args","").split(",").join("&"),Xa=h("audiofx",!1)&&null!=window.Tone;if(Xa){var wa=(new Tone.PolySynth(6,Tone.Synth)).toMaster(),eb={attack:.1,release:4,releaseCurve:"linear"},fb={baseFrequency:200,octaves:2,attack:0,decay:0,release:1E3};wa.set({voice0:{oscillator:{type:"sawtooth"},envelope:eb,filterEnvelope:fb},voice1:{oscillator:{type:"sine"},envelope:eb,filterEnvelope:fb},envelope:{attack:.33,decay:.2,release:.8,
sustain:.5},volume:-12});var va=(new Tone.Panner(0)).toMaster();wa.connect(va)}var ca=h("outer_margin",10),Ca=h("use_moment",!0),pb=h("clock_show_secs",!1),U=!1,V=!1,e={start_date:null,end_date:null,playback_date:null,playback_seconds_step:fa,position:0,canvas:null,position_canvas:null},ma,E=h("anim",x()?0:3),T=h("debug_labels",!1),Ib=h("debug",!1),hb=h("trace",!1),K=h("status",Ib),R=h("wall_margin",10),Va=h("start_offset",0),y=!1,w,ua=h("wall_seed_width",200),Y=new Stats;Y.setMode(0);c=b=null;var aa=
[],t,ba={x:0,y:0},Q=0,ea=[],P=[],la=!1,Ra="",Wa={css:{transform:"scale(1)"},delay:.33};Ca&&moment.tz.add(["Australia/Sydney|AEST AEDT|-a0 -b0|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 14o0 1o00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1tA0 WM0 1tA0 U00 1tA0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 11A0 1o00 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|40e5"]);
var l=function(a){this.use_moment=Ca;this.zone="Australia/Sydney";this.date=this.use_moment?null==a?moment.tz(this.zone):moment.tz(a,this.zone):null==a?new Date:new Date(a)};l.fromSQLStamp=function(a){return Ca?new l(a):new l(new Date(a.slice(0,4),a.slice(5,7)-1,a.slice(8,10),a.slice(11,13),a.slice(14,16),a.slice(17,19)))};l.prototype.getZoneAbbreviation=function(){return this.use_moment?moment.tz(this.zone).zoneAbbr():"AEST"};l.prototype.toLocaleTimeString=function(){return this.use_moment?this.date.format("h:mm a"):
this.date.toLocaleTimeString()};l.prototype.getSeconds=function(){return this.use_moment?this.date.seconds():this.date.getSeconds()};l.prototype.setSeconds=function(a){this.use_moment?this.date.seconds(a):this.date.setSeconds(a)};l.prototype.getTime=function(a){return this.use_moment?this.date.valueOf():this.date.getTime()};l.prototype.setTime=function(a){this.use_moment?this.date=moment(a).tz(this.zone):this.date.setTime(a)};l.prototype.getHours=function(){return this.use_moment?this.date.hours():
this.date.getHours()};l.prototype.getMinutes=function(){return this.use_moment?this.date.minutes():this.date.getMinutes()};l.prototype.getMonth=function(){return this.use_moment?this.date.month():this.date.getMonth()};l.prototype.getDay=function(){return this.use_moment?this.date.day():this.date.getDay()};l.prototype.getDate=function(){return this.use_moment?this.date.date():this.date.getDate()};l.prototype.getFullYear=function(){return this.use_moment?this.date.year():this.date.getFullYear()};var q=
function(a){this.index=a;this.published=!0;this.date_stamp="";this.date=null;this.date_of_work=this.title=this.uri="";this.location=[];this.creator=this.type_of_material="";this.topics=[];this.dewey=this.isbn=this.dig_no="";this.dewey_index=n.UnknownIndex;this.img_l=this.img_r=this.img_t=this.call_num=""};q.prototype.getSeedString=function(){var a=this.date_stamp;this.isbn.length?a+=this.isbn:this.dewey.length?a+=this.dewey:this.uri.length&&(a+=this.uri);return a};q.fromJson=function(a,b){var c=new q(b);
c.setVar(a,"title");c.setVar(a,"creator");c.setVar(a,"location");c.setVar(a,"work_date","date_of_work");c.setVar(a,"dig_no");c.setVar(a,"call_num");c.setVar(a,"dewey");c.setVar(a,"isbn");c.setVar(a,"topics");c.setVar(a,"mat_type","type_of_material");c.setVar(a,"img_t");c.setVar(a,"img_r");c.setVar(a,"img_l");c.published="1"==a.pub;a.hasOwnProperty("uri")&&(c.uri=c.published?unescape(a.uri).split("'").join("%27").split(" ").join("+"):unescape(a.uri));c.published&&(c.dewey.length?c.dewey_index=n.getIndex(c.dewey):
c.call_num.length&&-1!=c.call_num.indexOf(".")&&(c.dewey_index=n.getIndex(c.call_num)));a.hasOwnProperty("date")&&(c.date_stamp=a.date,c.date=l.fromSQLStamp(a.date),Gb&&(Math.seedrandom(c.getSeedString()),c.date.setSeconds(Math.floor(59*Math.random()))));return c};q.prototype.setVar=function(a,b,c){void 0==c&&(c=b);a.hasOwnProperty(b)&&(this[c]=a[b])};q.prototype.getLocationURL=function(){return this.published?"http://library.sl.nsw.gov.au/search~S2?/"+this.uri+"&srchanddisc=1":"http://acmssearch.sl.nsw.gov.au/search/itemDetailPaged.cgi?"+
this.uri+"&srchanddisc=1"};q.prototype.getImageURL=function(a){switch(a){case "img_t":case "img_r":case "img_l":return this.makeImageURL(a)}return""};q.prototype.getDivID=function(){return"card"+this.index};q.prototype.makeImageURL=function(a){return""==this[a]||void 0==this[a]?"":this.isPublished()?Eb+this[a]:Fb+this[a]};q.prototype.isPublished=function(){return this.published};q.prototype.getDateString=function(){return this.date.getFullYear()+"/"+Utils.pad(this.date.getMonth()+1)+"/"+Utils.pad(this.date.getDate())+
" "+Utils.pad(this.date.getHours())+":"+Utils.pad(this.date.getMinutes())+":"+Utils.pad(this.date.getSeconds())};q.prototype.hasImage=function(){return 0<this.img_t.length};q.prototype.hasRegularImage=function(){return 0<this.img_r.length};q.prototype.hasLargeImage=function(){return 0<this.img_l.length};q.prototype.getBestImgUrl=function(a){return this.hasLargeImage()&&"img_l"!=a?this.makeImageURL("img_l"):this.hasRegularImage()&&"img_r"!=a?this.makeImageURL("img_r"):"img_t"!=a?this.makeImageURL("img_t"):
null};q.prototype.toString=function(){return"[ "+this.index+", date='"+this.getDateString()+"', title='"+this.title+"' , img_t='"+this.img_t+"', url='"+this.getLocationURL()+"' ]"};var n=function(){};n.UnknownIndex=10;n.colours="#edcb48 #b4d05f #6fbb93 #6594bd #52abb5 #bc74af #dc8382 #e34476 #e52920 #e48031 #6b6b6b".split(" ");n.ranges=[0,100,200,300,400,500,600,700,800,900,1E3];n.categories="Comp science, information and General Works;Philosophy and Psychology;Religion;Social Sciences;Language;Science;Technology;Arts and Recreation;Literature;History and Geography;Unknown".split(";");
n.getCategoryNameFromCallNum=function(a){return this.getCategoryName(this.getIndex(a))};n.getCategoryName=function(a){return this.categories[a]};n.getHexFromCallNum=function(a){return this.getHex(this.getIndex(a))};n.getHex=function(a){return this.colours[a]};n.getRGBAFromCallNum=function(a,b){return this.getRGBA(this.getIndex(a),b)};n.getRGBA=function(a,b){return Utils.hexToRGBA(this.getHex(a),b)};n.getIndex=function(a){a=a.match(/([\d]{3,})/g);var b;null!=a&&(b=parseInt(a[0]));isNaN(b)&&(b=this.UnknownIndex);
0>b&&(b=this.UnknownIndex);a=this.ranges.length-1;for(var c=1;c<=a;c++)if(this.ranges[c]>b){c--;break}c>this.UnknownIndex&&(c=this.UnknownIndex);return c};return{init:function(){k("UnstackedAppinit");window.addEventListener("resize",Ab,!1);window.addEventListener("orientationchange",zb,!1);window.addEventListener("scroll",Bb,!1);document.addEventListener("keyup",Db,!1);x()&&(document.addEventListener("mousemove",Cb,!1),Ua=!0);if(I){var a=A();a.setSeconds(a.getSeconds()-600);ma=Utils.getSQLTimeStamp(a)}e.start_date=
e.end_date=e.playback_date=A();qb();w=new Freewall("#freewall");w.reset({selector:".card",animate:1==E,cellW:ua,cellH:"auto",gutterX:R,gutterY:R,onResize:function(){F()},bottomToTop:!1,delay:0});X&&ib(!xa);$(".tzone").text(A().getZoneAbbreviation());Sa(K);$("#status").prepend(Y.domElement);QuickSettings.useExtStyleSheet();t=QuickSettings.create(window.innerWidth-195,45,"[ Controls ]");v||t.addRange("Playback Speed",.0166,10,fa,.0166,function(a){fa=a;e.playback_seconds_step=fa});t.addBoolean("Playing",
y,function(a){a?oa(!0):pa(!0)});t.addRange("Visible Limit",0,255,G,1,function(a){G=a});v&&t.addDate("Current Data Date",A(),function(a){k("Date changed to "+a)});t.addDropDown("Data Source:",[r.BOTH.label,r.UNPUB.label,r.PUB.label],function(a){k("Show Source:",a.value);switch(a.value){case r.BOTH.label:D=r.BOTH.value;break;case r.UNPUB.label:D=r.UNPUB.value;break;case r.PUB.label:D=r.PUB.value}ja()});t.addDropDown("Image Filter:",[u.ALL.label,u.WITH_IMAGE.label,u.WITHOUT_IMAGE.label],function(a){k("Show Images:",
a.value);switch(a.value){case u.ALL.label:C=u.ALL.value;break;case u.WITH_IMAGE.label:C=u.WITH_IMAGE.value;break;case u.WITHOUT_IMAGE.label:C=u.WITHOUT_IMAGE.value}ja()});$("a").click(function(){k("Click",$(this).attr("href"));z("external_link","click",$(this).attr("href"))});v&&(e.start_date=A(),e.start_date.setSeconds(e.start_date.getSeconds()-60*na));(0==Aa||Utils.isMobile.any())&&t.toggleVisibility();Hb?(k("showHome",za),Utils.show("#home-box"),za&&($a=setTimeout(f,12E3)),$("#details-labels > p:lt(3)").html("&nbsp;"),
Za("#e34476",!1,2),c=$(".u_menu_sel")):Da&&L();ka()}}}();$(document).ready(function(){UnstackedApp.init()});
